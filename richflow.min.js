"use strict";(function(t,n){if("object"==typeof exports&&exports)n(exports);else{var s={};n(s),"function"==typeof define&&define.amd?define(s):t.RichFlow=s}})(this,function(t){function n(L,I){I.prev=L,L.next=I,I.rootFlow=L.rootFlow}function s(L,I){var k=function(O){setTimeout(()=>I._prePush(O,L),0)};L.subscribe(k),I.subscribers[L.key]=k}function o(L,I){I.subscribers[L.key]&&(L.unsubscribe(I.subscribers[L.key]),delete I.subscribers[L.key])}function u(L){var I;if(A.isNumber(L))I=function(k){var P=0;return{isDataEnd:function(){try{return!(P<k-1)&&(P=-1,!0)}finally{P++}}}}(Math.ceil(L));else if(A.isFunction(L))I=function(k){return{isDataEnd:k}}(L);else if(L.isDataEnd&&A.isFunction(L.isDataEnd))I=L;else throw new Error("Span length can be either a Number, a function or an object with an 'isDataEnd' function");return I}function p(){var L=[],I=0;this.getLength=function(){return L.length-I},this.isEmpty=function(){return 0==L.length},this.enqueue=function(k){L.push(k)},this.dequeue=function(){if(0!=L.length){var k=L[I];return 2*++I>=L.length&&(L=L.slice(I),I=0),k}},this.peek=function(){return 0<L.length?L[I]:void 0}}class m{constructor(){this.prev=null,this.next=null,this.pipeFunc=L=>L,this.rootFlow=null,this.terminalFunc=()=>{},this.isDiscretized=!1,this.elements=[],this.ended=!1,this.elemPos=0}process(){if(this.ended)return this._getElement();this.prev.next!=this&&(this.prev.next=this);var L=this.prev.process();return null==L&&this._addElement(null),L}startPush(){this.prev.startPush()}stopPush(){this.prev.stopPush()}reset(){this.ended=!1,this.elements=[]}pipe(L){var I=this.pipeFunc(L);return this._addElement(I),null===this.next?I:this.next.pipe(I)}push(L){var I=this.pipeFunc(L);null===this.next?this.terminalFunc(I):this.next.push(I)}setTerminalFunction(L){A.isFunction(L)&&(this.terminalFunc=L)}static from(L){return j.getFlow(L)}static of(){return 0==arguments.length?j.getFlow([]):1<arguments.length?j.getFlow(arguments):1==arguments.length&&A.isNumber(arguments[0])?new f(j.createIteratorWithEmptyArraysFromNumber(arguments[0])):j.getFlow(arguments[0])}static fromRange(L,I){return j.getFlow([...Array(I-L+1).keys()].map(k=>k+L))}static fromFile(L){return new f(j.createIteratorFromFileSystem(L))}static toArray(){return"toArray"}static toSet(){return"toSet"}static ASC(){return"ASC"}static DESC(){return"DESC"}static NUM_ASC(){return"NUM_ASC"}static NUM_DESC(){return"NUM_DESC"}limit(L){if(0>=L)throw new Error("Limit value must be greater than 0");var I=new x(0,L);return n(this,I),I}skip(L){if(0>=L)throw new Error("Skip value must be greater than 0");var I=new x(L,Number.MAX_VALUE);return n(this,I),I}skipUntil(L){if(!A.isFunction(L))throw new Error("skipUntil requires a function");var I=new y(L,1);return n(this,I),I}skipWhile(L){if(!A.isFunction(L))throw new Error("skipWhile requires a function");var I=new y(L,2);return n(this,I),I}takeUntil(L){if(!A.isFunction(L))throw new Error("takeUntil requires a function");var I=new y(L,3);return n(this,I),I}takeWhile(L){if(!A.isFunction(L))throw new Error("takeWhile requires a function");var I=new y(L,4);return n(this,I),I}range(L,I){if(0>L)throw new Error("Start Index cannot be negative");if(0>=I)throw new Error("End Index must be greater than 0");if(L>I)throw new Error("End Index cannot be less than Start Index");var k=new x(L,I);return n(this,k),k}select(L){var I=new m;return I.pipeFunc=A.isFunction(L)?L:function(k){return k[L]},n(this,I),I}map(L){return this.select(L)}selectExpand(L){var I=new h(L);return n(this,I),I}selectFlatten(){return this.selectExpand(L=>L)}where(L){var I=new g(L);return n(this,I),I}filter(L){return this.where(L)}static _sort(L){return function(I,k){return"num_asc"==L?I-k:"num_desc"==L?k-I:I<k?"asc"==L?-1:1:I>k?"asc"==L?1:-1:0}}orderBy(L){L||(L=m._sort("asc")),A.isFunction(L)?L==m.ASC?L=m._sort("asc"):L==m.DESC?L=m._sort("desc"):L==m.NUM_ASC?L=m._sort("num_asc"):L==m.NUM_DESC&&(L=m._sort("num_desc")):A.isString(L)&&(L=m._sort(L.toLowerCase()));var I=new F(L);return n(this,I),I}partitionBy(L){var I=L;A.isFunction(L)||(I=function(O){return O[L]});var k=new E(I);return n(this,k),k}discretize(L,I,k){void 0===k&&(k=!0);var O=new S(L,u(I),k);return n(this,O),this.isDiscretized=!0,O}count(){var I,k,L=0;for(k=this.next,this.next=null;null!=(I=this.process());)L++;return this.next=k,L}static toMap(L){var I=L;return A.isFunction(L)||(I=function(k){return k[L]}),I}_toSet(){var I,k,L=new Set;for(k=this.next,this.next=null;null!=(I=this.process());)L.add(I);return this.next=k,L}_toArray(){var I,k,L=[];for(k=this.next,this.next=null;null!=(I=this.process());)L.push(I);return this.next=k,L}groupBy(L){var I=L;A.isFunction(L)||(I=function(C){return C[L]});var k,O,M,P={};for(M=this.next,this.next=null;null!=(k=this.process());)O=I(k),P[O]||(P[O]=[]),P[O].push(k);return this.next=M,P}join(L){L||(L=",");var O,P,I="",k=0;for(P=this.next,this.next=null;null!=(O=this.process());)0<k&&(I+=L),I+=O,k++;return this.next=P,I}collect(L){if(!L)return this._toArray();let I=!1;if(A.isFunction(L)){if(L==m.toArray)return this._toArray();if(L==m.toSet)return this._toSet();I=!0}else if(A.isString(L)){if("toarray"==L.toLowerCase())return this._toArray();if("toset"==L.toLowerCase())return this._toSet();I=!0}if(I){let k=new Map;return m.from(this.groupBy(L)).foreach(O=>k.set(O.key,O.value)),k}return this._toArray()}foreach(L){var I,k;for(k=this.next,this.next=null;null!=(I=this.process());)L(I);this.next=k}forEach(L){this.foreach(L)}anyMatch(L){var I,k;for(k=this.next,this.next=null;null!=(I=this.process());)if(L(I))return!0;return this.next=k,!1}allMatch(L){var I,k;for(k=this.next,this.next=null;null!=(I=this.process());)if(!L(I))return!1;return this.next=k,!0}noneMatch(L){return!this.anyMatch(L)}findFirst(){var L,I;return I=this.next,this.next=null,L=this.process(),this.next=I,L}findAny(){return this.findFirst()}findLast(){var L,k,I=null;for(k=this.next,this.next=null;null!=(L=this.process());)I=L;return this.next=k,I}sum(){var L,k,I=0;for(k=this.next,this.next=null;null!=(L=this.process());)I+=L;return this.next=k,I}max(){var L,k,I=null;for(k=this.next,this.next=null;null!=(L=this.process());)(null==I||L>I)&&(I=L);return this.next=k,I}min(){var L,k,I=null;for(k=this.next,this.next=null;null!=(L=this.process());)(null==I||L<I)&&(I=L);return this.next=k,I}average(){var L,O,I=0,k=0;for(O=this.next,this.next=null;null!=(L=this.process());)I+=L,k++;return this.next=O,I/k}reduce(L,I){var k,P,O=L;for(P=this.next,this.next=null;null!=(k=this.process());)O=I(O,k);return this.next=P,O}_addElement(L){if(this.rootFlow.shouldCache&&!this.rootFlow.isStream()&&!this.ended){if(null==L)return void(this.ended=!0);this.elements.push(L)}}_getElement(){var L;try{return L=this.elemPos<this.elements.length?this.elements[this.elemPos]:null,L}finally{this.elemPos++,null==L&&(this.elemPos=0)}}}class f extends m{constructor(L){super(),this.iterators=[],this.iterators.push(L),this.rootFlow=this,this.pos=0,this.isListening=!1,this.subscribers={},this.streamElements=[],this.discreteStreamLength=1,this.isDataEndObject={isDataEnd:()=>!1},this.recall={},this.isParallel=!1,this.pFlow=null,this.shouldCache=!0}isStream(){return 0<this.iterators.length&&this.iterators[0].streamer&&A.isStreamer(this.iterators[0].streamer)}process(){if(this.pos>=this.iterators.length)return this.pos=0,null;if(!this.isDiscretized){for(var L=this.iterators[this.pos].next();L.done&&this.pos<this.iterators.length&&(this.pos++,!(this.pos>=this.iterators.length));)L=this.iterators[this.pos].next();return L.done?(this.pos=0,null):null===this.next?L.value:this.next.pipe(L.value)}var I=[];if(this.discreteStreamLength=Math.min(this.discreteStreamLength,this.iterators.length),1==this.discreteStreamLength){for(L=this.iterators[this.pos].next();L.done&&this.pos<this.iterators.length&&(this.pos++,!(this.pos>=this.iterators.length));)L=this.iterators[this.pos].next();if(L.done)return this.pos=0,null;for(;!L.done;){if(I.push(L.value),this.isDataEndObject.isDataEnd(L.value,I.length))return null===this.next?I:this.next.pipe(I);L=this.iterators[this.pos].next()}if(0<I.length)for(;;)if(I.push(null),this.isDataEndObject.isDataEnd(L.value,I.length))return null===this.next?I:this.next.pipe(I)}else{if(!this.recall.ended){this.recall.ended=[],this.recall.justEnded=!1;for(let O=0;O<this.discreteStreamLength;O++)this.recall.ended.push(!1)}do{if(this.recall.justEnded&&m.from(this.recall.ended).allMatch(O=>O))break;var k=[];for(let O=0;O<this.discreteStreamLength;O++)this.recall.ended[O]?k[O]=null:(L=this.iterators[O].next(),L.done?(this.recall.ended[O]=!0,k[O]=null):k[O]=L.value);if(this.recall.justEnded&&m.from(k).allMatch(O=>null==O))break;if(this.streamElements.push(k),this.isDataEndObject.isDataEnd(k,this.streamElements.length)){this.recall.justEnded=!0;try{return null===this.next?this.streamElements.slice():this.next.pipe(this.streamElements.slice())}finally{this.streamElements=[]}}else this.recall.justEnded=!1}while(!0);return this.pos=0,delete this.recall.ended,delete this.recall.justEnded,this.streamElements=[],null}}merge(L){var I=this.isStream(),k=j.getIterator(L);if(!I&&k.streamer||I&&!k.streamer)throw new Error("Streamer cannot be merged with other data types");return this.iterators.push(k),this}startPush(){this.isListening||(this.isListening=!0,this.isStream()?this._listen():this._doPush())}stopPush(){if(this.isListening&&(this.isListening=!1,this.isStream()))for(let L of this.iterators)o(L.streamer,this)}_doPush(){var L;if(!this.isDiscretized)for(;this.isListening&&!(this.pos>=this.iterators.length);){for(L=this.iterators[this.pos].next();L.done&&this.pos<this.iterators.length&&(this.pos++,!(this.pos>=this.iterators.length));)L=this.iterators[this.pos].next();if(L.done)break;this.push(L.value)}else if(this.discreteStreamLength=Math.min(this.discreteStreamLength,this.iterators.length),1==this.discreteStreamLength)do{for(L=this.iterators[this.pos].next();!L.done;)this.streamElements.push(L.value),this.isDataEndObject.isDataEnd(L.value,this.streamElements.length)&&(this.push(this.streamElements.slice()),this.streamElements=[]),L=this.iterators[this.pos].next();if(0<this.streamElements.length)for(;;)if(this.streamElements.push(null),this.isDataEndObject.isDataEnd(L.value,this.streamElements.length)){this.push(this.streamElements.slice()),this.streamElements=[];break}this.pos++}while(this.pos<this.iterators.length);else{var I=[],k=!1;for(let P=0;P<this.discreteStreamLength;P++)I.push(!1);do{var O=[];for(let P=0;P<this.discreteStreamLength;P++)I[P]?O[P]=null:(L=this.iterators[P].next(),L.done?(I[P]=!0,O[P]=null):O[P]=L.value);if(k&&m.from(O).allMatch(P=>null==P))break;if(this.streamElements.push(O),!this.isDataEndObject.isDataEnd(O,this.streamElements.length))k=!1;else if(k=!0,this.push(this.streamElements.slice()),this.streamElements=[],m.from(I).allMatch(P=>P))break}while(!0)}this.isListening=!1,this.pos=0}_listen(){if(this.isDiscretized){var L=[];for(let I of this.iterators)I.streamer&&(L.push(I.streamer),s(I.streamer,this));this.recall.streamKeys=m.from(L).select(I=>I.key).collect(m.toArray),this.recall.queues=m.from(L).select(()=>new p).collect(m.toArray),this.discreteStreamLength=Math.min(L.length,this.discreteStreamLength),this.recall.ready=!0,this.recall.called=!1,this.streamElements=[]}else for(let I of this.iterators)I.streamer&&s(I.streamer,this)}_prePush(L,I){if(!this.isDiscretized)this.push(L);else{this.recall.queues[this.recall.streamKeys.indexOf(I.key)].enqueue(L);var k=this;if(!this.recall.ready)return;this.recall.ready=!1,setTimeout(function(){Outer:do{var O=[];for(let P=0;P<k.discreteStreamLength;P++){if(k.recall.queues[P].isEmpty())break Outer;O.push(k.recall.queues[P].dequeue())}k.streamElements.push(O),k.isDataEndObject.isDataEnd(O,k.streamElements.length)&&(k.push(k.streamElements.slice()),k.streamElements=[])}while(!0);k.recall.called=!0,k.recall.ready=!0},this.recall.called?0:1e3)}}push(L){this.isListening&&(null===this.next?this.terminalFunc(L):this.next.push(L))}discretize(L,I,k){void 0===k&&(k=!0),this.discreteStreamLength=L,this.isDataEndObject=u(I),this.isDiscretized=!0;var O=new S(L,this.isDataEndObject,k);return n(this,O),O}}class h extends m{constructor(L){super(),this.pipeFunc=L,this.iteratorFlow=null}process(){if(this.ended)return this._getElement();this.prev.next!=this&&(this.prev.next=this);var L;return null==this.iteratorFlow?(L=this.prev.process(),null==L&&this._addElement(null),L):(L=this.iteratorFlow.process(),null==L)?(this.iteratorFlow=null,L=this.prev.process(),null==L&&this._addElement(null),L):(this._addElement(L),null===this.next?L:this.next.pipe(L))}pipe(L){return this.iteratorFlow=m.from(this.pipeFunc(L)),this.process()}push(L){this.iteratorFlow=m.from(this.pipeFunc(L));for(var I;null!=(I=this.process());)null===this.next?this.terminalFunc(I):this.next.push(I)}}class x extends m{constructor(L,I){super(),this.start=L,this.end=I,this.position=0}pipe(L){if(this.position<this.end){if(this.position++,this.position<=this.start){var I=this.prev.process();return null==I&&this._addElement(null),I}return this._addElement(L),null===this.next?L:this.next.pipe(L)}return this.position=0,this._addElement(null),null}push(L){if(this.position<this.end){if(this.position++,this.position<=this.start||this.position>=this.end)return;null===this.next?this.terminalFunc(L):this.next.push(L)}}}class g extends m{constructor(L){super(),this.pipeFunc=L}pipe(L){var I=this.pipeFunc(L);return I?(this._addElement(L),null===this.next?L:this.next.pipe(L)):this.prev.process()}push(L){var I=this.pipeFunc(L);I&&(null===this.next?this.terminalFunc(L):this.next.push(L))}}class F extends m{constructor(L){super(),this.pipeFunc=L,this.items=[],this.obtainedAll=!1,this.pos=0}process(){if(this.ended)return this._getElement();this.prev.next!=this&&(this.prev.next=this);var L;if(!this.obtainedAll){if(L=this.prev.process(),null!=L)return L;this.obtainedAll=!0,this.items.sort(this.pipeFunc)}if(this.pos<this.items.length)L=this.items[this.pos++];else return this.elements=this.items.slice(),this.ended=!0,this.elemPos=0,this.pos=0,this.items=[],this.obtainedAll=!1,null;return null===this.next?L:this.next.pipe(L)}pipe(L){return this.items.push(L),this.process()}push(L){null===this.next?this.terminalFunc(L):this.next.push(L)}}class E extends m{constructor(L){super(),this.pipeFunc=L,this.partitions={},this.obtainedAll=!1,this.iterator=null}process(){if(this.ended)return this._getElement();this.prev.next!=this&&(this.prev.next=this);var L;if(!this.obtainedAll){if(L=this.prev.process(),null!=L)return L;this.obtainedAll=!0,this.iterator=j.createIteratorFromObject(this.partitions)}return(L=this.iterator.next(),L.done)?(this._addElement(null),this.iterator=null,this.obtainedAll=!1,null):(L=L.value,this._addElement(L),null===this.next?L:this.next.pipe(L))}pipe(L){var I=this.pipeFunc(L);return this.partitions[I]||(this.partitions[I]=[]),this.partitions[I].push(L),this.process()}push(L){null===this.next?this.terminalFunc(L):this.next.push(L)}}class y extends m{constructor(L,I){super(),this.pipeFunc=L,this.method=I,this.finished=!1}pipe(L){var I;switch(this.method){case 1:if(this.finished||this.pipeFunc(L))this.finished=!0,I=L;else return I=this.prev.process(),null==I&&this._addElement(I),I;break;case 2:if(!this.finished&&this.pipeFunc(L))return I=this.prev.process(),null==I&&this._addElement(I),I;this.finished=!0,I=L;break;case 3:this.finished||this.pipeFunc(L)?(I=this.finished?null:L,this.finished=!0):I=L;break;case 4:!this.finished&&this.pipeFunc(L)?I=L:(this.finished=!0,I=null);}return this._addElement(I),null==I?(this.finished=!1,null):null===this.next?I:this.next.pipe(I)}push(L){var I;switch(this.method){case 1:if(this.finished||this.pipeFunc(L))this.finished=!0,I=L;else return;break;case 2:if(!this.finished&&this.pipeFunc(L))return;this.finished=!0,I=L;break;case 3:if(!(this.finished||this.pipeFunc(L)))I=L;else if(!this.finished)I=L,this.finished=!0;else return;break;case 4:if(!this.finished&&this.pipeFunc(L))I=L;else return void(this.finished=!0);}null===this.next?this.terminalFunc(I):this.next.push(I)}}class S extends m{constructor(L,I,k){super(),this.span=0<L?L:1,this.isDataEndObject=I,this.spawnFlows=k,this.items=[]}process(){return this.prev.next!=this&&(this.prev.next=this),this.prev.process()}pipe(L){if(this.prev instanceof f&&!this.isDiscretized)this.items=L;else{var I=L;if(1!=this.span){if(!A.isArray(L)){var k=j.getFlow(L);I=[];var P,O=!1;for(let C=0;C<this.span;C++)O?I.add(null):(P=k.process(),I.push(P),null==P&&(O=!0));k=null}else if(this.span<I.length)I.splice(this.span);else if(this.span>I.length)for(;this.span!=I.length;)I.push(null);if(this.items.push(I),!this.isDataEndObject.isDataEnd(I,this.items.length))return this.prev.process()}else if(this.items.push(I),!this.isDataEndObject.isDataEnd(I,this.items.length))return this.prev.process()}var M=this.spawnFlows?new v(this.items):this.items;try{return null===this.next?M:this.next.pipe(M)}finally{this.items=[]}}push(L){if(this.prev instanceof f&&!this.isDiscretized)this.items=L;else{var I=L;if(1!=this.span){if(!A.isArray(L)){var k=j.getFlow(L);I=[];var P,O=!1;for(let C=0;C<this.span;C++)O?I.add(null):(P=k.process(),I.push(P),null==P&&(O=!0));k=null}else if(this.span<I.length)I.splice(this.span);else if(this.span>I.length)for(;this.span!=I.length;)I.push(null);if(this.items.push(I),!this.isDataEndObject.isDataEnd(I,this.items.length))return}else if(this.items.push(L),!this.isDataEndObject.isDataEnd(L,this.items.length))return}var M;M=this.spawnFlows?new v(this.items):this.items,null===this.next?this.terminalFunc(M):this.next.push(M),this.items=[]}}class v extends f{constructor(L){super(j.createIteratorFromArray(L)),this.elements=L}elementSize(){return this.elements.length}streamSize(){try{return this.elements[0].length}catch(L){return 1}}}class _{constructor(L){this.listeners=[],this.receiver=L&&A.isFunction(L)?L:null,this.key=A.generateUUID()}push(L,I){null!=this.receiver&&this.receiver(L,I)}subscribe(L){if(L.notify&&A.isFunction(L.notify)||A.isFunction(L))this.listeners.push(L);else throw new Error("Listener object must either be a function or an object with a `notify` function.")}send(L){m.from(this.listeners).where(I=>I.notify&&A.isFunction(I.notify)).foreach(I=>I.notify(L)),m.from(this.listeners).where(I=>!(I.notify&&A.isFunction(I.notify))&&A.isFunction(I)).foreach(I=>I(L))}unsubscribe(L){let I=this.listeners.indexOf(L);0<=I&&this.listeners.splice(I,1)}size(){return 0}get(){return{}}}class j{static getFlow(L){return new f(j.getIterator(L))}static getIterator(L){let I;return I=A.isArray(L)&&!A.isString(L)?j.createIteratorFromArray(L):A.isMap(L)?j.createIteratorFromMap(L):A.isSet(L)?j.createIteratorFromSet(L):A.isString(L)&&L.toLowerCase().startsWith("fs://")?j.createIteratorFromFileSystem(L):A.isStreamer(L)?j.createIteratorFromStreamer(L):A.isGenerator(L)?j.createIteratorFromGenerator(L):A.isIterable(L)&&!A.isString(L)?j.createIteratorFromIterable(L):A.isObject(L)&&!A.isString(L)?j.createIteratorFromObject(L):j.createIteratorFromValue(L),I}static createIteratorFromArray(L){return function(I){let k=I,O=0;return{next:function(){try{return O<k.length?{value:k[O],done:!1}:{done:!0}}finally{O++,O>k.length&&(O=0)}}}}(L)}static createIteratorWithEmptyArraysFromNumber(L){L=Math.ceil(L);for(var I=[];L--;)I.push([]);return j.createIteratorFromArray(I)}static createIteratorFromMap(L){return function(I){let k=I,O=k.entries();return{next:function(){let P=O.next();return P.done?(O=k.entries(),P):{value:{key:P.value[0],value:P.value[1]},done:!1}}}}(L)}static createIteratorFromSet(L){return j.createIteratorFromArray(Array.from(L))}static createIteratorFromIterable(L){return L}static createIteratorFromGenerator(L){return function(I){let k=I,O=k(),P;return{next:function(){try{return P=O.next(),P}finally{P.done&&(O=k())}}}}(L)}static createIteratorFromObject(L){return function(I){let k=I,O=Object.keys(k),P=0,M=O.length;return{next:function(){try{return P<M?{value:{key:O[P],value:k[O[P]]},done:!1}:{done:!0}}finally{P++,P>M&&(P=0,O=Object.keys(k),M=O.length)}}}}(L)}static createIteratorFromFileSystem(L){return function(){"fs://"==L.trim().substring(0,"fs://".length)&&(L=L.trim().substring("fs://".length));let I=require("n-readlines"),k=new I(L);return{next:function(){let O=k.next();return O?{value:O.toString("utf8"),done:!1}:(k=new I(L),{done:!0})}}}()}static createIteratorFromValue(L){return function(){let I=!1;return{next:function(){try{return I?{done:!0}:{value:L,done:!1}}finally{I=!I}}}}()}static createIteratorFromStreamer(L){return function(){let I=L.size(),k={},O=0,P;return{next:function(){try{return O>=I?{done:!0}:(P=L.get(O),{value:null==P?k:P,done:!1})}finally{O++,O>I&&(O=0,I=L.size())}},streamer:L}}()}}var A={isFunction:function(L){return"function"==typeof L||!1},isArray:function(L){return"number"==typeof L.length&&0<=L.length},isSet:function(L){return L instanceof Set&&A.isFunction(L.values)},isMap:function(L){return L instanceof Map&&A.isFunction(L.values)},isObject:function(L){return!!L&&"object"==typeof L},isString:function(L){return"[object String]"===Object.prototype.toString.call(L)},isIn:function(L,I){for(let k=0;k<I.length;k++)if(L===I[k])return!0;return!1},isNumber:function(L){return"[object Number]"===Object.prototype.toString.call(L)},isIterable:function(L){return A.isFunction(L[Symbol.iterator])||L.next&&A.isFunction(L.next)},isGenerator:function(L){var I=function*(){}.constructor;return L instanceof I},isStreamer:function(L){return L instanceof _},generateUUID:function(){var L=new Date().getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(L+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(I){var k=0|(L+16*Math.random())%16;return L=Math.floor(L/16),("x"===I?k:8|3&k).toString(16)})}};t.Flow=m,t.InFlow=class extends m{constructor(L){super(),L.subscribe(this)}notify(L){this.push(L)}process(){return null}},t.OutFlow=class extends m{constructor(L,I,k){if(super(),!(L instanceof m))throw new Error("Source is NOT a Flow");if(!A.isStreamer(I))throw new Error("`streamer` is not a Streamer");this.streamer=I?I:new _,this.key=k?k:A.generateUUID(),this.source=L,n(L,this),this.pipeFunc=O=>O}start(){this.rootFlow.startPush()}stop(){this.rootFlow.stopPush()}push(L){this.streamer.push(L,this.key)}},t.Streamer=_,Object.defineProperty(t,"__esModule",{value:!0})});